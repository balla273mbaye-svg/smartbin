<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>‚ôªÔ∏è Smart Bin Dashboard</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            max-width: 1200px;
            margin: auto;
            background-color: #f0f2f5;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #11998e;
        }

        .container {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        .column {
            flex: 1;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        #status-box {
            padding: 20px;
            border-radius: 12px;
            font-size: 1.5em;
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        #results-box {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #11998e;
            margin-bottom: 20px;
        }

        #analyze-btn {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            border: none;
            font-size: 1.2em;
            padding: 15px 40px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }

        #graph {
            margin-top: 20px;
        }

        img {
            max-width: 100%;
            border-radius: 12px;
            margin-bottom: 20px;
        }
    </style>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>‚ôªÔ∏è Smart Bin Dashboard</h1>

    <div class="container">
        <!-- Colonne gauche -->
        <div class="column">
            <input type="file" id="imageInput" accept="image/*"><br>
            <button id="analyze-btn">üîç Analyser la poubelle</button>
        </div>

        <!-- Colonne droite -->
        <div class="column">
            <div id="status-box">Statut de la poubelle</div>
            <img id="output-image" src="" alt="Image annot√©e">
            <div id="results-box">D√©tails des d√©tections</div>
            <div id="stats-box">Statistiques actuelles</div>
            <div id="graph"></div>
        </div>
    </div>

    <script>
        // Historique pour le graphique
        let full_history = [];
        let empty_history = [];
        const max_len = 20;

        const statusBox = document.getElementById("status-box");
        const resultsBox = document.getElementById("results-box");
        const statsBox = document.getElementById("stats-box");
        const graphDiv = document.getElementById("graph");
        const outputImage = document.getElementById("output-image");

        document.getElementById("analyze-btn").addEventListener("click", 
() => {
            const fileInput = document.getElementById("imageInput");
            if (fileInput.files.length === 0) {
                alert("Veuillez uploader une image !");
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                // Afficher l'image dans l'interface
                outputImage.src = e.target.result;

                // Ici tu peux appeler ton backend (Python/Django) pour 
analyser l'image
                // Pour la d√©mo, on simule des donn√©es al√©atoires
                const pleine_count = Math.floor(Math.random() * 3);
                const vide_count = Math.floor(Math.random() * 3);

                // Mettre √† jour l'historique
                if (full_history.length >= max_len) full_history.shift();
                if (empty_history.length >= max_len) 
empty_history.shift();
                full_history.push(pleine_count);
                empty_history.push(vide_count);

                // Mettre √† jour l'interface
                statusBox.textContent = pleine_count > 0 ? `üî¥ 
${pleine_count} poubelle(s) pleine(s)` : "üü¢ Toutes les poubelles sont 
vides";
                resultsBox.innerHTML = `Poubelles pleines: ${pleine_count} 
<br> Poubelles vides: ${vide_count}`;
                statsBox.innerHTML = `üìä Pleines: ${pleine_count}, Vides: 
${vide_count}`;

                // Graphique Plotly
                const trace1 = {x: [...Array(full_history.length).keys()], 
y: full_history, name: 'Poubelles Pleines', type: 'bar', marker: {color: 
'red'}};
                const trace2 = {x: 
[...Array(empty_history.length).keys()], y: empty_history, name: 
'Poubelles Vides', type: 'bar', marker: {color: 'green'}};
                Plotly.newPlot(graphDiv, [trace1, trace2], {title: 'üìä 
Historique des d√©tections', barmode: 'stack'});
            }
            reader.readAsDataURL(file);
        });
    </script>
</body>
</html>

